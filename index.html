<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>MITM Control Panel</title>
  <style>
    body {
      font-family: sans-serif;
      margin: 2em;
      background: #f7f7f7;
    }
    h1 {
      color: #444;
    }
    textarea {
      width: 100%;
      height: 200px;
      margin-top: 1em;
      font-family: monospace;
    }
    input, button {
      margin: 0.5em 0;
      padding: 0.5em;
      font-size: 1em;
    }
    .error {
      color: red;
    }
    .success {
      color: green;
    }
  </style>
</head>
<body>
  <h1>üîß MITM Replacement Control</h1>

  <label for="urlInput">Target URL(s) to replace (comma-separated):</label><br />
  <input type="text" id="urlInput" placeholder="example.com, example.org" /><br />

  <label for="htmlInput">Replacement HTML content:</label><br />
  <textarea id="htmlInput" placeholder="&lt;h1&gt;Injected Page&lt;/h1&gt;"></textarea><br />

  <button onclick="updateConfig()">üíæ Update Config</button>

  <p id="status" class="success"></p>

  <script>
    const configURL = 'https://adamtuwima.github.io/bandana/config.json';
    const replacementURL = 'https://adamtuwima.github.io/bandana/replacement.html';

    async function fetchConfig() {
      try {
        const res = await fetch(configURL);
        if (!res.ok) throw new Error(`HTTP ${res.status}`);
        const config = await res.json();
        document.getElementById('urlInput').value = config.targets.join(", ");
        const html = await (await fetch(config.replacement_url)).text();
        document.getElementById('htmlInput').value = html;
      } catch (err) {
        document.getElementById('status').textContent = `‚ùå Error loading config.json: ${err.message}`;
        document.getElementById('status').className = 'error';
      }
    }

    async function updateConfig() {
      const urls = document.getElementById('urlInput').value.split(',').map(u => u.trim());
      const html = document.getElementById('htmlInput').value;

      const newConfig = {
        targets: urls,
        replacement_url: replacementURL
      };

      try {
        // –ü—Å–µ–≤–¥–æ-–∑–∞–≥—Ä—É–∑–∫–∞ ‚Äî –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ —Ç—ã –¥–æ–ª–∂–µ–Ω –≤—Ä—É—á–Ω—É—é –∑–∞–ª–∏—Ç—å —ç—Ç–æ—Ç config.json –∏ replacement.html –Ω–∞ GitHub
        console.log("‚¨ÜÔ∏è Upload these to your GitHub:");
        console.log("config.json:", JSON.stringify(newConfig, null, 2));
        console.log("replacement.html:", html);

        document.getElementById('status').textContent = "‚úÖ Config prepared ‚Äî upload these to GitHub manually.";
        document.getElementById('status').className = 'success';
      } catch (err) {
        document.getElementById('status').textContent = `‚ùå Failed: ${err.message}`;
        document.getElementById('status').className = 'error';
      }
    }

    fetchConfig();
  </script>
</body>
</html>